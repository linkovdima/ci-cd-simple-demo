name: Deploy to GitHub Pages

on:
  push:
    branches: [main]

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4
      
      - name: ğŸ” Validate files
        run: |
          echo "=== ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² ==="
          echo "Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ: $(pwd)"
          echo ""
          echo "ğŸ“ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:"
          ls -la
          echo ""
          
          if [ -f "index.html" ]; then
            echo "âœ… index.html Ğ½Ğ°Ğ¹Ğ´ĞµĞ½"
            echo "ĞŸĞµÑ€Ğ²Ñ‹Ğµ 3 ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ñ„Ğ°Ğ¹Ğ»Ğ°:"
            head -3 index.html
          else
            echo "âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: index.html Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!"
            exit 1
          fi
          
          echo ""
          echo "âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ° ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾"
      
      - name: ğŸ“Š Show build info
        run: |
          echo "=== Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑĞ±Ğ¾Ñ€ĞºĞµ ==="
          echo "Ğ’Ñ€ĞµĞ¼Ñ ÑĞ±Ğ¾Ñ€ĞºĞ¸: $(date)"
          echo "Ğ’ĞµÑ‚ĞºĞ°: ${{ github.ref }}"
          echo "ĞšĞ¾Ğ¼Ğ¼Ğ¸Ñ‚: ${{ github.sha }}"
          echo "ĞĞ²Ñ‚Ğ¾Ñ€: ${{ github.actor }}"
          
          # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ„Ğ°Ğ¹Ğ» Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸ĞµĞ¹
          echo "Build Information" > build.txt
          echo "=================" >> build.txt
          echo "Time: $(date)" >> build.txt
          echo "Commit: ${{ github.sha }}" >> build.txt
          echo "Workflow: ${{ github.workflow }}" >> build.txt
          
          echo ""
          echo "ğŸ“„ Ğ¤Ğ°Ğ¹Ğ» build.txt ÑĞ¾Ğ·Ğ´Ğ°Ğ½"
          cat build.txt
  
  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
      
      - name: âš™ï¸ Setup Pages
        uses: actions/configure-pages@v4
      
      - name: ğŸ“¦ Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: '.'
      
      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4