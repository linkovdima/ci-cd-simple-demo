name: Simple CI/CD Pipeline

on:
  push:
    branches: [main, master]

permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ðŸ” File validation
        run: |
          echo "=== FILE VALIDATION ==="
          echo "Current directory: $(pwd)"
          echo "Files in repository:"
          ls -la
          
          if [ ! -f "index.html" ]; then
            echo "Creating index.html file..."
            cat > index.html << 'HTML_EOF'
<!DOCTYPE html>
<html>
<head>
    <title>CI/CD Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ CI/CD Pipeline Working!</h1>
        <p>This page was deployed by GitHub Actions</p>
        <p>Build time: <span id="time">Loading...</span></p>
        <script>
            document.getElementById('time').textContent = new Date().toLocaleString();
        </script>
    </div>
</body>
</html>
HTML_EOF
            echo "âœ… index.html created"
          else
            echo "âœ… index.html exists"
          fi

      - name: ðŸ“Š Build information
        run: |
          echo "=== BUILD INFO ==="
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref }}"
          echo "Commit: ${{ github.sha }}"
          
          cat > build-info.txt << EOF
Build Information
=================
Timestamp: $(date)
Repository: ${{ github.repository }}
Branch: ${{ github.ref }}
Commit: ${{ github.sha }}
Actor: ${{ github.actor }}
Run ID: ${{ github.run_id }}
EOF

      - name: ðŸš€ Deploy to GitHub Pages
        if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master'
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .
          clean: true

      - name: âœ… Success notification
        if: success()
        run: |
          echo ""
          echo "ðŸŽ‰ CI/CD PIPELINE SUCCESSFUL!"
          echo "=============================="
          echo "Your site will be available at:"
          echo "ðŸ‘‰ https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/"